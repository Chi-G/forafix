<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Track Service - ForaFix | Real-time Service Tracking</title>
    <meta name="description" content="Track your ForaFix service in real-time. Monitor agent location, service progress, and communicate directly with your service provider." />
    <link rel="stylesheet" href="../css/main.css" />
    <link rel="icon" type="image/x-icon" href="../public/favicon.ico" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<script type="module" src="https://static.rocket.new/rocket-web.js?_cfg=https%3A%2F%2Fforafix2891back.builtwithrocket.new&_be=https%3A%2F%2Fapplication.rocket.new&_v=0.1.8"></script>
</head>
<body class="bg-background text-text-primary">
    <!-- Sticky Header -->
    <header class="sticky top-0 z-50 bg-background/95 backdrop-blur-sm border-b border-slate-700/20">
        <nav class="container mx-auto px-4 py-4">
            <div class="flex items-center justify-between">
                <!-- Logo -->
                <div class="flex items-center space-x-2">
                    <div class="w-30 h-10 bg-primary rounded-lg flex items-center justify-center">
                        <img src="../public/logo.png" alt="ForaFix Logo" class="w-30 h-10 object-contain rounded-lg" />
                    </div>
                </div>

                <!-- Desktop Navigation -->
                <div class="hidden md:flex items-center space-x-8">
                    <a href="public_landing_page.html" class="text-text-secondary hover:text-accent transition-colors">Home</a>
                    <a href="service_booking_flow.html" class="text-text-secondary hover:text-accent transition-colors">Services</a>
                    <a href="user_dashboard.html" class="text-text-secondary hover:text-accent transition-colors">Dashboard</a>
                    <a href="agent_dashboard.html" class="text-text-secondary hover:text-accent transition-colors">Become Agent</a>
                    <a href="real_time_service_tracking.html" class="text-accent hover:text-accent transition-colors">Track Service</a>
                </div>

                <!-- CTA Button & Mobile Menu -->
                <div class="flex items-center space-x-4">
                    <a href="service_booking_flow.html" class="btn-accent hidden sm:inline-flex">Book Service</a>
                    
                    <!-- Mobile Menu Button -->
                    <button id="mobile-menu-btn" class="md:hidden p-2 text-text-primary hover:text-accent transition-colors">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
                        </svg>
                    </button>
                </div>
            </div>

            <!-- Mobile Menu -->
            <div id="mobile-menu" class="md:hidden hidden mt-4 pb-4 border-t border-slate-700/20">
                <div class="flex flex-col space-y-4 pt-4">
                    <a href="public_landing_page.html" class="text-text-secondary hover:text-accent transition-colors">Home</a>
                    <a href="service_booking_flow.html" class="text-text-secondary hover:text-accent transition-colors">Services</a>
                    <a href="user_dashboard.html" class="text-text-secondary hover:text-accent transition-colors">Dashboard</a>
                    <a href="agent_dashboard.html" class="text-text-secondary hover:text-accent transition-colors">Become Agent</a>
                    <a href="real_time_service_tracking.html" class="text-accent hover:text-accent transition-colors">Track Service</a>
                    <a href="service_booking_flow.html" class="btn-accent w-full text-center mt-4">Book Service</a>
                </div>
            </div>
        </nav>
    </header>

    <!-- Service Tracking Header -->
    <section class="bg-surface border-b border-slate-700/20">
        <div class="container mx-auto px-4 py-6">
            <div class="flex flex-col md:flex-row md:items-center justify-between gap-4">
                <div class="flex items-center space-x-4">
                    <button onclick="history.back()" class="p-2 hover:bg-slate-700/50 rounded-lg transition-colors">
                        <svg class="w-5 h-5 text-text-secondary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                        </svg>
                    </button>
                    <div>
                        <h1 class="text-2xl font-bold">Service Tracking</h1>
                        <p class="text-text-secondary">Booking Reference: <span class="text-accent font-medium">#FF2025-0901-HC</span></p>
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="text-right">
                        <div class="text-sm text-text-secondary">Estimated Completion</div>
                        <div class="text-lg font-semibold text-success" id="completion-time">2:30 PM</div>
                    </div>
                    <button id="emergency-btn" class="btn-accent">
                        <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"/>
                        </svg>
                        Emergency
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Main Tracking Interface -->
    <section class="py-6">
        <div class="container mx-auto px-4">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <!-- Map and Progress Column -->
                <div class="lg:col-span-2 space-y-6">
                    <!-- Interactive Map -->
                    <div class="card">
                        <div class="flex items-center justify-between mb-4">
                            <h2 class="text-xl font-semibold">Live Location</h2>
                            <div class="flex items-center space-x-2">
                                <div class="w-2 h-2 bg-success rounded-full animate-pulse"></div>
                                <span class="text-sm text-success">Live</span>
                            </div>
                        </div>
                        
                        <!-- Map Container -->
                        <div class="relative h-80 bg-slate-700 rounded-lg overflow-hidden">
                            <img src="https://images.unsplash.com/photo-1524661135-423995f22d0b?w=800&h=400&fit=crop&crop=center" alt="Service area map" class="w-full h-full object-cover" loading="lazy" onerror="this.src='https://images.unsplash.com/photo-1584824486509-112e4181ff6b?q=80&w=2940&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D'; this.onerror=null;" />
                            
                            <!-- Agent Location Marker -->
                            <div class="absolute top-1/3 left-1/2 transform -translate-x-1/2 -translate-y-1/2">
                                <div class="relative">
                                    <div class="w-8 h-8 bg-accent rounded-full border-4 border-white shadow-lg flex items-center justify-center animate-pulse">
                                        <svg class="w-4 h-4 text-white" fill="currentColor" viewBox="0 0 24 24">
                                            <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
                                        </svg>
                                    </div>
                                    <div class="absolute -bottom-8 left-1/2 transform -translate-x-1/2 bg-accent text-white px-2 py-1 rounded text-xs whitespace-nowrap">
                                        Agent Location
                                    </div>
                                </div>
                            </div>

                            <!-- Customer Location Marker -->
                            <div class="absolute bottom-1/4 right-1/3 transform translate-x-1/2 translate-y-1/2">
                                <div class="relative">
                                    <div class="w-8 h-8 bg-primary rounded-full border-4 border-white shadow-lg flex items-center justify-center">
                                        <svg class="w-4 h-4 text-white" fill="currentColor" viewBox="0 0 24 24">
                                            <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
                                        </svg>
                                    </div>
                                    <div class="absolute -bottom-8 left-1/2 transform -translate-x-1/2 bg-primary text-white px-2 py-1 rounded text-xs whitespace-nowrap">
                                        Your Location
                                    </div>
                                </div>
                            </div>

                            <!-- Route Line -->
                            <svg class="absolute inset-0 w-full h-full pointer-events-none">
                                <path d="M 200 120 Q 300 180 400 200" stroke="#ff6b35" stroke-width="3" stroke-dasharray="5,5" fill="none" opacity="0.8">
                                    <animate attributeName="stroke-dashoffset" values="0;10" dur="1s" repeatCount="indefinite"/>
                                </path>
                            </svg>

                            <!-- Map Controls -->
                            <div class="absolute top-4 right-4 flex flex-col space-y-2">
                                <button class="w-10 h-10 bg-white/90 hover:bg-white rounded-lg shadow-md flex items-center justify-center transition-colors">
                                    <svg class="w-5 h-5 text-slate-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"/>
                                    </svg>
                                </button>
                                <button class="w-10 h-10 bg-white/90 hover:bg-white rounded-lg shadow-md flex items-center justify-center transition-colors">
                                    <svg class="w-5 h-5 text-slate-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 12H4"/>
                                    </svg>
                                </button>
                            </div>

                            <!-- Distance Info -->
                            <div class="absolute bottom-4 left-4 bg-white/90 backdrop-blur-sm rounded-lg px-3 py-2">
                                <div class="text-sm text-slate-700">
                                    <div class="font-semibold">2.3 km away</div>
                                    <div class="text-xs">ETA: 8 minutes</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Service Progress Timeline -->
                    <div class="card">
                        <h2 class="text-xl font-semibold mb-6">Service Progress</h2>
                        
                        <div class="space-y-6">
                            <!-- Completed Step -->
                            <div class="flex items-start space-x-4">
                                <div class="flex-shrink-0 w-8 h-8 bg-success rounded-full flex items-center justify-center">
                                    <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
                                    </svg>
                                </div>
                                <div class="flex-1">
                                    <div class="flex items-center justify-between">
                                        <h3 class="font-semibold text-success">Service Booked</h3>
                                        <span class="text-sm text-text-secondary">1:15 PM</span>
                                    </div>
                                    <p class="text-text-secondary text-sm mt-1">Your house cleaning service has been confirmed</p>
                                </div>
                            </div>

                            <!-- Current Step -->
                            <div class="flex items-start space-x-4">
                                <div class="flex-shrink-0 w-8 h-8 bg-accent rounded-full flex items-center justify-center animate-pulse">
                                    <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
                                    </svg>
                                </div>
                                <div class="flex-1">
                                    <div class="flex items-center justify-between">
                                        <h3 class="font-semibold text-accent">En Route</h3>
                                        <span class="text-sm text-text-secondary">1:45 PM</span>
                                    </div>
                                    <p class="text-text-secondary text-sm mt-1">Adebayo is on the way to your location</p>
                                    <div class="mt-2">
                                        <div class="w-full bg-slate-700 rounded-full h-2">
                                            <div class="bg-accent h-2 rounded-full animate-pulse" style="width: 65%"></div>
                                        </div>
                                        <p class="text-xs text-text-secondary mt-1">65% of journey completed</p>
                                    </div>
                                </div>
                            </div>

                            <!-- Upcoming Steps -->
                            <div class="flex items-start space-x-4 opacity-50">
                                <div class="flex-shrink-0 w-8 h-8 bg-slate-600 rounded-full flex items-center justify-center">
                                    <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
                                    </svg>
                                </div>
                                <div class="flex-1">
                                    <h3 class="font-semibold">Arrived</h3>
                                    <p class="text-text-secondary text-sm mt-1">Agent will arrive at your location</p>
                                </div>
                            </div>

                            <div class="flex items-start space-x-4 opacity-50">
                                <div class="flex-shrink-0 w-8 h-8 bg-slate-600 rounded-full flex items-center justify-center">
                                    <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M19.36 2.72L20.78 4.14L15.06 9.85C16.13 11.39 16.28 13.24 15.38 14.44L9.06 8.12C10.26 7.22 12.11 7.37 13.65 8.44L19.36 2.72M5.93 17.57C3.92 15.56 2.69 13.16 2.35 10.92L7.23 8.83L14.67 16.27L12.58 21.15C10.34 20.81 7.94 19.58 5.93 17.57Z"/>
                                    </svg>
                                </div>
                                <div class="flex-1">
                                    <h3 class="font-semibold">In Progress</h3>
                                    <p class="text-text-secondary text-sm mt-1">Service work will begin</p>
                                </div>
                            </div>

                            <div class="flex items-start space-x-4 opacity-50">
                                <div class="flex-shrink-0 w-8 h-8 bg-slate-600 rounded-full flex items-center justify-center">
                                    <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
                                    </svg>
                                </div>
                                <div class="flex-1">
                                    <h3 class="font-semibold">Completed</h3>
                                    <p class="text-text-secondary text-sm mt-1">Service will be completed and reviewed</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Photo Gallery -->
                    <div class="card">
                        <div class="flex items-center justify-between mb-4">
                            <h2 class="text-xl font-semibold">Service Photos</h2>
                            <span class="text-sm text-text-secondary">Updates automatically</span>
                        </div>
                        
                        <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
                            <div class="relative aspect-square bg-slate-700 rounded-lg overflow-hidden cursor-pointer hover:opacity-80 transition-opacity" onclick="openPhotoModal(0)">
                                <img src="https://images.pexels.com/photos/4099468/pexels-photo-4099468.jpeg?auto=compress&cs=tinysrgb&w=300&h=300&fit=crop" alt="Before cleaning photo" class="w-full h-full object-cover" loading="lazy" onerror="this.src='https://images.unsplash.com/photo-1584824486509-112e4181ff6b?q=80&w=2940&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D'; this.onerror=null;" />
                                <div class="absolute bottom-2 left-2 bg-black/70 text-white px-2 py-1 rounded text-xs">
                                    Before
                                </div>
                            </div>
                            
                            <div class="relative aspect-square bg-slate-700 rounded-lg overflow-hidden cursor-pointer hover:opacity-80 transition-opacity" onclick="openPhotoModal(1)">
                                <img src="https://images.pixabay.com/photos/2020/04/18/08/33/kitchen-5058732_1280.jpg?auto=compress&cs=tinysrgb&w=300&h=300&fit=crop" alt="During cleaning photo" class="w-full h-full object-cover" loading="lazy" onerror="this.src='https://images.unsplash.com/photo-1584824486509-112e4181ff6b?q=80&w=2940&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D'; this.onerror=null;" />
                                <div class="absolute bottom-2 left-2 bg-black/70 text-white px-2 py-1 rounded text-xs">
                                    In Progress
                                </div>
                            </div>
                            
                            <div class="relative aspect-square bg-slate-700 rounded-lg border-2 border-dashed border-slate-600 flex items-center justify-center">
                                <div class="text-center">
                                    <svg class="w-8 h-8 text-slate-500 mx-auto mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                                    </svg>
                                    <p class="text-sm text-slate-500">More photos coming</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Service Details and Chat Column -->
                <div class="space-y-6">
                    <!-- Service Details Card -->
                    <div class="card">
                        <h2 class="text-xl font-semibold mb-4">Service Details</h2>
                        
                        <div class="space-y-4">
                            <div>
                                <div class="text-sm text-text-secondary">Service Type</div>
                                <div class="font-semibold">House Cleaning</div>
                            </div>
                            
                            <div>
                                <div class="text-sm text-text-secondary">Scheduled Time</div>
                                <div class="font-semibold">Today, 2:00 PM - 4:00 PM</div>
                            </div>
                            
                            <div>
                                <div class="text-sm text-text-secondary">Address</div>
                                <div class="font-semibold">15 Gimbiya Street, Garki Area 11, Abuja</div>
                            </div>
                            
                            <div>
                                <div class="text-sm text-text-secondary">Total Cost</div>
                                <div class="font-semibold text-accent">₦8,500</div>
                            </div>
                        </div>
                    </div>

                    <!-- Agent Profile Card -->
                    <div class="card">
                        <h2 class="text-xl font-semibold mb-4">Your Agent</h2>
                        
                        <div class="flex items-center space-x-4 mb-4">
                            <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=60&h=60&fit=crop&crop=face" alt="Adebayo Ogundimu" class="w-15 h-15 rounded-full object-cover" loading="lazy" onerror="this.src='https://images.unsplash.com/photo-1584824486509-112e4181ff6b?q=80&w=2940&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D'; this.onerror=null;" />
                            <div class="flex-1">
                                <h3 class="font-semibold">Adebayo Ogundimu</h3>
                                <div class="flex items-center space-x-2">
                                    <div class="flex">
                                        <svg class="w-4 h-4 text-accent" fill="currentColor" viewBox="0 0 24 24">
                                            <path d="M12 17.27L18.18 21L16.54 13.97L22 9.24L14.81 8.63L12 2L9.19 8.63L2 9.24L7.46 13.97L5.82 21L12 17.27Z"/>
                                        </svg>
                                        <svg class="w-4 h-4 text-accent" fill="currentColor" viewBox="0 0 24 24">
                                            <path d="M12 17.27L18.18 21L16.54 13.97L22 9.24L14.81 8.63L12 2L9.19 8.63L2 9.24L7.46 13.97L5.82 21L12 17.27Z"/>
                                        </svg>
                                        <svg class="w-4 h-4 text-accent" fill="currentColor" viewBox="0 0 24 24">
                                            <path d="M12 17.27L18.18 21L16.54 13.97L22 9.24L14.81 8.63L12 2L9.19 8.63L2 9.24L7.46 13.97L5.82 21L12 17.27Z"/>
                                        </svg>
                                        <svg class="w-4 h-4 text-accent" fill="currentColor" viewBox="0 0 24 24">
                                            <path d="M12 17.27L18.18 21L16.54 13.97L22 9.24L14.81 8.63L12 2L9.19 8.63L2 9.24L7.46 13.97L5.82 21L12 17.27Z"/>
                                        </svg>
                                        <svg class="w-4 h-4 text-accent" fill="currentColor" viewBox="0 0 24 24">
                                            <path d="M12 17.27L18.18 21L16.54 13.97L22 9.24L14.81 8.63L12 2L9.19 8.63L2 9.24L7.46 13.97L5.82 21L12 17.27Z"/>
                                        </svg>
                                    </div>
                                    <span class="text-sm text-text-secondary">4.9 (127 reviews)</span>
                                </div>
                                <p class="text-sm text-text-secondary">3+ years experience</p>
                            </div>
                        </div>
                        
                        <div class="flex space-x-2">
                            <button id="call-agent-btn" class="btn-primary flex-1">
                                <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"/>
                                </svg>
                                Call
                            </button>
                            <button id="message-agent-btn" class="btn-outline flex-1">
                                <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M20 2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h4v3c0 .6.4 1 1 1 .2 0 .5-.1.7-.3L14.4 18H20c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2z"/>
                                </svg>
                                Message
                            </button>
                        </div>
                    </div>

                    <!-- Live Chat Interface -->
                    <div class="card">
                        <div class="flex items-center justify-between mb-4">
                            <h2 class="text-xl font-semibold">Live Chat</h2>
                            <div class="flex items-center space-x-2">
                                <div class="w-2 h-2 bg-success rounded-full"></div>
                                <span class="text-sm text-success">Online</span>
                            </div>
                        </div>
                        
                        <!-- Chat Messages -->
                        <div class="space-y-4 mb-4 max-h-64 overflow-y-auto scrollbar-thin" id="chat-messages">
                            <!-- Agent Message -->
                            <div class="flex items-start space-x-3">
                                <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=32&h=32&fit=crop&crop=face" alt="Adebayo" class="w-8 h-8 rounded-full object-cover flex-shrink-0" loading="lazy" onerror="this.src='https://images.unsplash.com/photo-1584824486509-112e4181ff6b?q=80&w=2940&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D'; this.onerror=null;" />
                                <div class="flex-1">
                                    <div class="bg-slate-700 rounded-lg px-3 py-2">
                                        <p class="text-sm">Hello! I'm on my way to your location. I should arrive in about 8 minutes. Is there anything specific you'd like me to focus on during the cleaning?</p>
                                    </div>
                                    <span class="text-xs text-text-secondary mt-1">1:47 PM</span>
                                </div>
                            </div>
                            
                            <!-- User Message -->
                            <div class="flex items-start space-x-3 justify-end">
                                <div class="flex-1 text-right">
                                    <div class="bg-accent rounded-lg px-3 py-2 inline-block">
                                        <p class="text-sm text-white">Hi Adebayo! Please pay special attention to the kitchen and bathroom. Thank you!</p>
                                    </div>
                                    <span class="text-xs text-text-secondary mt-1 block">1:48 PM</span>
                                </div>
                            </div>
                            
                            <!-- Agent Message -->
                            <div class="flex items-start space-x-3">
                                <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=32&h=32&fit=crop&crop=face" alt="Adebayo" class="w-8 h-8 rounded-full object-cover flex-shrink-0" loading="lazy" onerror="this.src='https://images.unsplash.com/photo-1584824486509-112e4181ff6b?q=80&w=2940&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D'; this.onerror=null;" />
                                <div class="flex-1">
                                    <div class="bg-slate-700 rounded-lg px-3 py-2">
                                        <p class="text-sm">Perfect! I'll make sure to give those areas extra attention. See you soon! 👍</p>
                                    </div>
                                    <span class="text-xs text-text-secondary mt-1">1:49 PM</span>
                                </div>
                            </div>
                            
                            <!-- Typing Indicator -->
                            <div class="flex items-start space-x-3" id="typing-indicator" style="display: none;">
                                <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=32&h=32&fit=crop&crop=face" alt="Adebayo" class="w-8 h-8 rounded-full object-cover flex-shrink-0" loading="lazy" onerror="this.src='https://images.unsplash.com/photo-1584824486509-112e4181ff6b?q=80&w=2940&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D'; this.onerror=null;" />
                                <div class="bg-slate-700 rounded-lg px-3 py-2">
                                    <div class="flex space-x-1">
                                        <div class="w-2 h-2 bg-text-secondary rounded-full animate-bounce"></div>
                                        <div class="w-2 h-2 bg-text-secondary rounded-full animate-bounce" style="animation-delay: 0.1s"></div>
                                        <div class="w-2 h-2 bg-text-secondary rounded-full animate-bounce" style="animation-delay: 0.2s"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Chat Input -->
                        <div class="flex space-x-2">
                            <input type="text" id="chat-input" placeholder="Type your message..." class="form-input flex-1" onkeypress="handleChatKeyPress(event)" />
                            <button id="send-message-btn" class="btn-accent px-4">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Photo Modal -->
    <div id="photo-modal" class="fixed inset-0 bg-black/80 z-50 hidden flex items-center justify-center p-4">
        <div class="relative max-w-4xl max-h-full">
            <button onclick="closePhotoModal()" class="absolute top-4 right-4 text-white hover:text-accent transition-colors z-10">
                <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                </svg>
            </button>
            <img id="modal-image" src alt class="max-w-full max-h-full object-contain rounded-lg" />
            <div class="absolute bottom-4 left-4 bg-black/70 text-white px-3 py-2 rounded-lg">
                <div id="modal-caption" class="font-semibold"></div>
                <div id="modal-timestamp" class="text-sm opacity-75"></div>
            </div>
        </div>
    </div>

    <!-- Emergency Contact Modal -->
    <div id="emergency-modal" class="fixed inset-0 bg-black/50 z-50 hidden flex items-center justify-center p-4">
        <div class="bg-surface rounded-lg p-6 max-w-md w-full">
            <div class="flex items-center space-x-3 mb-4">
                <div class="w-12 h-12 bg-error/20 rounded-full flex items-center justify-center">
                    <svg class="w-6 h-6 text-error" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"/>
                    </svg>
                </div>
                <div>
                    <h3 class="text-lg font-semibold">Emergency Contact</h3>
                    <p class="text-text-secondary text-sm">Get immediate assistance</p>
                </div>
            </div>
            
            <div class="space-y-3 mb-6">
                <button class="w-full btn-accent">
                    <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"/>
                    </svg>
                    Call Support: +234 (0) 800 FORAFIX
                </button>
                <button class="w-full btn-outline">
                    <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M20 2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h4v3c0 .6.4 1 1 1 .2 0 .5-.1.7-.3L14.4 18H20c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2z"/>
                    </svg>
                    Live Chat Support
                </button>
            </div>
            
            <button onclick="closeEmergencyModal()" class="w-full btn-outline">Cancel</button>
        </div>
    </div>

    <script>
        // Mobile menu toggle
        const mobileMenuBtn = document.getElementById('mobile-menu-btn');
        const mobileMenu = document.getElementById('mobile-menu');

        mobileMenuBtn.addEventListener('click', () => {
            mobileMenu.classList.toggle('hidden');
        });

        // Photo modal functionality
        const photoModal = document.getElementById('photo-modal');
        const modalImage = document.getElementById('modal-image');
        const modalCaption = document.getElementById('modal-caption');
        const modalTimestamp = document.getElementById('modal-timestamp');

        const photos = [
            {
                src: 'https://images.pexels.com/photos/4099468/pexels-photo-4099468.jpeg?auto=compress&cs=tinysrgb&w=800&h=600&fit=crop',
                caption: 'Before Cleaning',
                timestamp: '1:45 PM'
            },
            {
                src: 'https://images.pixabay.com/photos/2020/04/18/08/33/kitchen-5058732_1280.jpg',
                caption: 'Work in Progress',
                timestamp: '2:15 PM'
            }
        ];

        function openPhotoModal(index) {
            const photo = photos[index];
            modalImage.src = photo.src;
            modalImage.alt = photo.caption;
            modalCaption.textContent = photo.caption;
            modalTimestamp.textContent = photo.timestamp;
            photoModal.classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        }

        function closePhotoModal() {
            photoModal.classList.add('hidden');
            document.body.style.overflow = 'auto';
        }

        // Emergency modal functionality
        const emergencyBtn = document.getElementById('emergency-btn');
        const emergencyModal = document.getElementById('emergency-modal');

        emergencyBtn.addEventListener('click', () => {
            emergencyModal.classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        });

        function closeEmergencyModal() {
            emergencyModal.classList.add('hidden');
            document.body.style.overflow = 'auto';
        }

        // Chat functionality
        const chatInput = document.getElementById('chat-input');
        const sendMessageBtn = document.getElementById('send-message-btn');
        const chatMessages = document.getElementById('chat-messages');
        const typingIndicator = document.getElementById('typing-indicator');

        function handleChatKeyPress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        function sendMessage() {
            const message = chatInput.value.trim();
            if (!message) return;

            // Add user message
            const userMessage = createMessageElement(message, true);
            chatMessages.appendChild(userMessage);
            
            // Clear input
            chatInput.value = '';
            
            // Scroll to bottom
            chatMessages.scrollTop = chatMessages.scrollHeight;
            
            // Show typing indicator
            typingIndicator.style.display = 'flex';
            
            // Simulate agent response
            setTimeout(() => {
                typingIndicator.style.display = 'none';
                const agentResponse = createMessageElement("Thanks for the message! I'll keep you updated on my progress.", false);
                chatMessages.appendChild(agentResponse);
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }, 2000);
        }

        function createMessageElement(text, isUser) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `flex items-start space-x-3 ${isUser ? 'justify-end' : ''}`;
            
            const currentTime = new Date().toLocaleTimeString('en-US', { 
                hour: 'numeric', 
                minute: '2-digit',
                hour12: true 
            });
            
            if (isUser) {
                messageDiv.innerHTML = `
                    <div class="flex-1 text-right">
                        <div class="bg-accent rounded-lg px-3 py-2 inline-block">
                            <p class="text-sm text-white">${text}</p>
                        </div>
                        <span class="text-xs text-text-secondary mt-1 block">${currentTime}</span>
                    </div>
                `;
            } else {
                messageDiv.innerHTML = `
                    <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=32&h=32&fit=crop&crop=face" 
                         alt="Adebayo" 
                         class="w-8 h-8 rounded-full object-cover flex-shrink-0"
                         loading="lazy"
                         onerror="this.src='https://images.unsplash.com/photo-1584824486509-112e4181ff6b?q=80&w=2940&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D'; this.onerror=null;">
                    <div class="flex-1">
                        <div class="bg-slate-700 rounded-lg px-3 py-2">
                            <p class="text-sm">${text}</p>
                        </div>
                        <span class="text-xs text-text-secondary mt-1">${currentTime}</span>
                    </div>
                `;
            }
            
            return messageDiv;
        }

        sendMessageBtn.addEventListener('click', sendMessage);

        // Agent contact functionality
        document.getElementById('call-agent-btn').addEventListener('click', () => {
            alert('Calling Adebayo Ogundimu...\n+234 803 123 4567');
        });

        document.getElementById('message-agent-btn').addEventListener('click', () => {
            chatInput.focus();
        });

        // Real-time updates simulation
        function updateProgress() {
            const progressBar = document.querySelector('.bg-accent.h-2');
            let currentWidth = 65;
            
            setInterval(() => {
                if (currentWidth < 100) {
                    currentWidth += Math.random() * 2;
                    progressBar.style.width = `${Math.min(currentWidth, 100)}%`;
                }
            }, 30000); // Update every 30 seconds
        }

        function updateETA() {
            const etaElement = document.getElementById('completion-time');
            const currentTime = new Date();
            currentTime.setMinutes(currentTime.getMinutes() + Math.floor(Math.random() * 10) + 45);
            
            etaElement.textContent = currentTime.toLocaleTimeString('en-US', {
                hour: 'numeric',
                minute: '2-digit',
                hour12: true
            });
        }

        // Initialize real-time features
        updateProgress();
        setInterval(updateETA, 60000); // Update ETA every minute

        // Close modals when clicking outside
        photoModal.addEventListener('click', (e) => {
            if (e.target === photoModal) {
                closePhotoModal();
            }
        });

        emergencyModal.addEventListener('click', (e) => {
            if (e.target === emergencyModal) {
                closeEmergencyModal();
            }
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                if (!photoModal.classList.contains('hidden')) {
                    closePhotoModal();
                }
                if (!emergencyModal.classList.contains('hidden')) {
                    closeEmergencyModal();
                }
            }
        });

        // Simulate push notifications
        function simulateNotification(message) {
            if ('Notification' in window && Notification.permission === 'granted') {
                new Notification('ForaFix Service Update', {
                    body: message,
                    icon: '/favicon.ico'
                });
            }
        }

        // Request notification permission
        if ('Notification' in window && Notification.permission === 'default') {
            Notification.requestPermission();
        }

        // Simulate status updates
        setTimeout(() => {
            simulateNotification('Your agent is 5 minutes away from your location');
        }, 60000);

        // Auto-scroll chat to bottom on load
        chatMessages.scrollTop = chatMessages.scrollHeight;
    </script>
<script id="dhws-dataInjector" src="../public/dhws-data-injector.js"></script>
</body>
</html>